"use strict";(globalThis.webpackChunk_openmrs_esm_patient_list_app=globalThis.webpackChunk_openmrs_esm_patient_list_app||[]).push([[716],{7729:(t,e,n)=>{n.d(e,{Z:()=>o});var a=n(272),i=n.n(a),r=n(2609),s=n.n(r)()(i());s.push([t.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-list__add-patient__productiveHeading02___Tg4Ke{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0)}.-esm-patient-list__add-patient__productiveHeading03___ZLZfS{font-size:var(--cds-heading-03-font-size, 1.25rem);font-weight:var(--cds-heading-03-font-weight, 400);line-height:var(--cds-heading-03-line-height, 1.4);letter-spacing:var(--cds-heading-03-letter-spacing, 0)}.-esm-patient-list__add-patient__productiveHeading04___IJa64{font-size:var(--cds-heading-04-font-size, 1.75rem);font-weight:var(--cds-heading-04-font-weight, 400);line-height:var(--cds-heading-04-line-height, 1.28572);letter-spacing:var(--cds-heading-04-letter-spacing, 0)}.-esm-patient-list__add-patient__bodyLong01___kZia8{font-size:var(--cds-body-01-font-size, 0.875rem);font-weight:var(--cds-body-01-font-weight, 400);line-height:var(--cds-body-01-line-height, 1.42857);letter-spacing:var(--cds-body-01-letter-spacing, 0.16px)}.-esm-patient-list__add-patient__bodyShort01___nA8Cw{font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px)}.-esm-patient-list__add-patient__bodyShort02___nmEwy{font-size:var(--cds-body-compact-02-font-size, 1rem);font-weight:var(--cds-body-compact-02-font-weight, 400);line-height:var(--cds-body-compact-02-line-height, 1.375);letter-spacing:var(--cds-body-compact-02-letter-spacing, 0)}.-esm-patient-list__add-patient__text02___LHem6{color:#525252}.-esm-patient-list__add-patient__label01___GtOx4{font-size:var(--cds-label-01-font-size, 0.75rem);font-weight:var(--cds-label-01-font-weight, 400);line-height:var(--cds-label-01-line-height, 1.33333);letter-spacing:var(--cds-label-01-letter-spacing, 0.32px)}.-esm-patient-list__add-patient__modal___o88NP{position:fixed;width:100vw;height:100vh;display:grid;background-color:rgba(0,0,0,.5);z-index:9000;justify-items:center;align-items:center}.-esm-patient-list__add-patient__modalContent___AWM2H{width:100%;background-color:#f4f4f4}.-esm-patient-list__add-patient__modalHeader___C25Zv{margin:1rem}.-esm-patient-list__add-patient__patientListList___hlyTd{padding:0 1rem}.-esm-patient-list__add-patient__checkbox___KWZkw{padding-bottom:.875rem}.-esm-patient-list__add-patient__pagination___qvsDi{width:100%;overflow:hidden}.-esm-patient-list__add-patient__paginationContainer___KJmP9{display:flex;justify-content:space-between;align-items:center;position:relative}.-esm-patient-list__add-patient__itemsCountDisplay___jAW9C{position:absolute;top:0;left:1rem;height:3rem;display:flex;align-items:center;color:#525252}.-esm-patient-list__add-patient__pagination___qvsDi>div:first-child{visibility:hidden;width:0}.-esm-patient-list__add-patient__buttonSet___snp28{display:flex;justify-content:space-between;align-items:flex-start}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/style.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss","webpack://./src/add-patient/add-patient.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCnDF,6DCs0BI,uDAAA,CAAA,0DAAA,CAAA,4DAAA,CAAA,8DAAA,CDl0BJ,6DCk0BI,kDAAA,CAAA,kDAAA,CAAA,kDAAA,CAAA,sDAAA,CD9zBJ,6DC8zBI,kDAAA,CAAA,kDAAA,CAAA,sDAAA,CAAA,sDAAA,CD1zBJ,oDC0zBI,gDAAA,CAAA,+CAAA,CAAA,mDAAA,CAAA,wDAAA,CDtzBJ,qDCszBI,wDAAA,CAAA,uDAAA,CAAA,2DAAA,CAAA,gEAAA,CDlzBJ,qDCkzBI,oDAAA,CAAA,uDAAA,CAAA,yDAAA,CAAA,2DAAA,CD9yBJ,gDACE,aDxBQ,CC2BV,iDC0yBI,gDAAA,CAAA,gDAAA,CAAA,oDAAA,CAAA,yDAAA,CDtyBJ,+CACE,cAAA,CACA,WAAA,CACA,YAAA,CACA,YAAA,CACA,+BAAA,CACA,YAAA,CACA,oBAAA,CACA,kBAAA,CE1CF,sDACE,UAAA,CACA,wBAAA,CAGF,qDACE,WAAA,CAGF,yDACE,cAAA,CAGF,kDACE,sBAAA,CAGF,oDACE,UAAA,CACA,eAAA,CAGF,6DACE,YAAA,CACA,6BAAA,CACA,kBAAA,CACA,iBAAA,CAGF,2DACE,iBAAA,CACA,KAAA,CACA,SAAA,CACA,WAAA,CACA,YAAA,CACA,kBAAA,CACA,aAAA,CAGF,oEACE,iBAAA,CACA,OAAA,CAGF,mDACE,YAAA,CACA,6BAAA,CACA,sBAAA",sourceRoot:""}]),s.locals={productiveHeading02:"-esm-patient-list__add-patient__productiveHeading02___Tg4Ke",productiveHeading03:"-esm-patient-list__add-patient__productiveHeading03___ZLZfS",productiveHeading04:"-esm-patient-list__add-patient__productiveHeading04___IJa64",bodyLong01:"-esm-patient-list__add-patient__bodyLong01___kZia8",bodyShort01:"-esm-patient-list__add-patient__bodyShort01___nA8Cw",bodyShort02:"-esm-patient-list__add-patient__bodyShort02___nmEwy",text02:"-esm-patient-list__add-patient__text02___LHem6",label01:"-esm-patient-list__add-patient__label01___GtOx4",modal:"-esm-patient-list__add-patient__modal___o88NP",modalContent:"-esm-patient-list__add-patient__modalContent___AWM2H",modalHeader:"-esm-patient-list__add-patient__modalHeader___C25Zv",patientListList:"-esm-patient-list__add-patient__patientListList___hlyTd",checkbox:"-esm-patient-list__add-patient__checkbox___KWZkw",pagination:"-esm-patient-list__add-patient__pagination___qvsDi",paginationContainer:"-esm-patient-list__add-patient__paginationContainer___KJmP9",itemsCountDisplay:"-esm-patient-list__add-patient__itemsCountDisplay___jAW9C",buttonSet:"-esm-patient-list__add-patient__buttonSet___snp28"};const o=s},716:(t,e,n)=>{n.r(e),n.d(e,{default:()=>J,useAddablePatientLists:()=>T});var a=n(268),i=n.n(a),r=n(4924),s=n(3255),o=n(2870),l=n(5860),c=n(2565),d=n(1354),A=n.n(d),_=n(1583),u=n.n(_),p=n(7378),m=n.n(p),f=n(5993),h=n.n(f),C=n(4154),g=n.n(C),y=n(8141),b=n.n(y),v=n(7729),w={};w.styleTagTransform=b(),w.setAttributes=h(),w.insert=m().bind(null,"head"),w.domAPI=u(),w.insertStyleElement=g(),A()(v.Z,w);const D=v.Z&&v.Z.locals?v.Z.locals:void 0;function k(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function E(t,e,n,a,i,r,s){try{var o=t[r](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(a,i)}function x(t){return function(){var e=this,n=arguments;return new Promise((function(a,i){var r=t.apply(e,n);function s(t){E(r,a,i,s,o,"next",t)}function o(t){E(r,a,i,s,o,"throw",t)}s(void 0)}))}}function S(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var a,i,r=[],s=!0,o=!1;try{for(n=n.call(t);!(s=(a=n.next()).done)&&(r.push(a.value),!e||r.length!==e);s=!0);}catch(t){o=!0,i=t}finally{try{s||null==n.return||n.return()}finally{if(o)throw i}}return r}}(t,e)||L(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(t){return function(t){if(Array.isArray(t))return k(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||L(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(t,e){if(t){if("string"==typeof t)return k(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(t,e):void 0}}var z=function(t,e){var n,a,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}};function T(t){var e=(0,r.useTranslation)().t,n=(0,o.useConfig)();return(0,s.ZP)(["addablePatientLists",t],x((function(){var a,i,r;return z(this,(function(s){switch(s.label){case 0:return[4,Promise.allSettled([I(t,e),N(t,n.myListCohortTypeUUID,n.systemListCohortTypeUUID)])];case 1:return a=S.apply(void 0,[s.sent(),2]),i=a[0],r=a[1],[2,B("fulfilled"===i.status?i.value:[]).concat(B("fulfilled"===r.status?r.value:[]))]}}))})))}function N(t,e,n){return P.apply(this,arguments)}function P(){return(P=x((function(t,e,n){var a,i,r;return z(this,(function(s){switch(s.label){case 0:return[4,Promise.all([(0,c.SA)({},e,n),(0,c.U6)(t)])];case 1:return a=S.apply(void 0,[s.sent(),2]),i=a[0],r=a[1],[2,i.map((function(e){return{id:e.id,displayName:e.display,checked:r.includes(e.id),addPatient:function(){return x((function(){return z(this,(function(n){switch(n.label){case 0:return[4,(0,c.xj)({cohort:e.id,patient:t,startDate:(0,o.toOmrsIsoString)(new Date)})];case 1:return n.sent(),[2]}}))}))()}}}))]}}))}))).apply(this,arguments)}function I(t,e){return H.apply(this,arguments)}function H(){return(H=x((function(t,e){return z(this,(function(n){switch(n.label){case 0:return[4,(0,o.getDynamicOfflineDataEntries)("patient")];case 1:return[2,n.sent().some((function(e){return e.identifier===t}))?[]:[{id:"fake-offline-patient-list",displayName:e("offlinePatients","Offline patients"),addPatient:function(){return x((function(){return z(this,(function(e){switch(e.label){case 0:return[4,(0,o.putDynamicOfflineData)("patient",t)];case 1:return e.sent(),[4,(0,o.syncDynamicOfflineData)("patient",t)];case 2:return e.sent(),[2]}}))}))()}}]]}}))}))).apply(this,arguments)}const J=function(t){var e=t.closeModal,n=t.patientUuid,s=(0,r.useTranslation)().t,c=S((0,a.useState)(""),2),d=c[0],A=c[1],_=S((0,a.useState)([]),2),u=_[0],p=_[1],m=T(n),f=m.data,h=m.isLoading,C=(0,a.useCallback)((function(t,e){p(e?function(e){return B(e).concat([t])}:function(e){return e.filter((function(e){return e!==t}))})}),[]),g=(0,a.useCallback)((function(){var t=!0,n=!1,a=void 0;try{for(var i,r=function(){var t=i.value,e=f.find((function(e){return e.id===t}));if(!e)return"continue";e.addPatient().then((function(){return(0,o.showToast)({title:s("successfullyAdded","Successfully added"),kind:"success",description:"".concat(s("successAddPatientToList","Patient added to list"),": ").concat(e.displayName)})})).catch((function(){return(0,o.showToast)({title:s("error","Error"),kind:"error",description:"".concat(s("errorAddPatientToList","Patient not added to list"),": ").concat(e.displayName)})}))},l=u[Symbol.iterator]();!(t=(i=l.next()).done);t=!0)r()}catch(t){n=!0,a=t}finally{try{t||null==l.return||l.return()}finally{if(n)throw a}}e()}),[f,u,e,s]),y=(0,a.useMemo)((function(){if(!f)return[];if((null==d?void 0:d.trim().length)>0){var t=d.toLowerCase();return f.filter((function(e){return e.displayName.toLowerCase().includes(t)}))}return f}),[d,f]),b=(0,o.usePagination)(y,5),v=b.results,w=b.goTo,k=b.currentPage,E=b.paginated;return(0,a.useEffect)((function(){1!==k&&w(1)}),[d]),i().createElement("div",{className:D.modalContent},i().createElement("div",{className:D.modalHeader},i().createElement("h1",{className:D.productiveHeading03},s("addPatientToList","Add patient to list")),i().createElement("h3",{className:D.bodyLong01,style:{margin:"1rem 0"}},s("searchForAListToAddThisPatientTo","Search for a list to add this patient to."))),i().createElement("div",{style:{marginBottom:"0.875rem"}},i().createElement(l.olm,{style:{backgroundColor:"white",borderBottom:"1px solid #e0e0e0"},labelText:s("searchForList","Search for a list"),placeholder:"Filter list",onChange:function(t){var e=t.target;A(e.value)},value:d})),i().createElement("div",{className:D.patientListList},i().createElement("fieldset",{className:"cds--fieldset"},i().createElement("p",{className:"cds--label"},"Patient Lists"),!h&&v?v.length>0?v.map((function(t){return i().createElement("div",{key:t.id,className:D.checkbox},i().createElement(l.XZJ,{key:t.id,onChange:function(e){return C(t.id,e.target.checked)},checked:t.checked||u.includes(t.id),disabled:t.checked,labelText:t.displayName,id:t.id}))})):i().createElement("p",{className:D.bodyLong01},s("noPatientListFound","No patient list found")):i().createElement(i().Fragment,null,i().createElement("div",{className:D.checkbox},i().createElement(l.jJq,null)),i().createElement("div",{className:D.checkbox},i().createElement(l.jJq,null)),i().createElement("div",{className:D.checkbox},i().createElement(l.jJq,null)),i().createElement("div",{className:D.checkbox},i().createElement(l.jJq,null)),i().createElement("div",{className:D.checkbox},i().createElement(l.jJq,null))))),E&&i().createElement("div",{className:D.paginationContainer},i().createElement("span",{className:"".concat(D.itemsCountDisplay," ").concat(D.bodyLong01)},v.length*k," / ",y.length," ",s("items","items")),i().createElement(l.tlE,{className:D.pagination,forwardText:"",backwardText:"",page:k,pageSize:5,pageSizes:[5],totalItems:y.length,onChange:function(t){var e=t.page;return w(e)}})),i().createElement("div",{className:D.buttonSet},i().createElement(l.zxk,{kind:"ghost",size:"xl",onClick:function(){(0,o.navigate)({to:"${openmrsSpaBase}/home/patient-lists?new_cohort=true"}),e()}},s("createNewPatientList","Create new patient list")),i().createElement("div",null,i().createElement(l.zxk,{kind:"secondary",size:"xl",onClick:e},s("cancel","Cancel")),i().createElement(l.zxk,{onClick:g,size:"xl"},s("addToList","Add to list")))))}}}]);